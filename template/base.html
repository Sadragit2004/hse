<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Ø³ÛŒØ³ØªÙ… HSE{% endblock %}</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <link href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@100;200;300;400;500;600;700;800;900&display=swap" rel="stylesheet">

    <style>
        :root {
            /* Palette Ù…Ø¯Ø±Ù†â€ŒØªØ± */
            --primary: #1a5f7a;
            --primary-light: #2c8f9e;
            --secondary: #57cc99;
            --accent: #ffd166;
            --danger: #ef476f;
            --warning: #ff9a3c;
            --dark: #1d3557;
            --light: #f8f9fa;
            --white: #ffffff;

            /* Ø±Ù†Ú¯â€ŒÙ‡Ø§ÛŒ Ù¾Ù†Ù„ */
            --sidebar-bg: #212529;
            --sidebar-link-hover: rgba(255, 255, 255, 0.1);
            --sidebar-active: #1a5f7a;
            --bg-light: #f5f9ff;
        }

        body {
            font-family: 'Vazirmatn', sans-serif;
            background: var(--bg-light);
            color: #333;
            background-image:
                radial-gradient(circle at 10% 20%, rgba(86, 180, 211, 0.05) 0%, transparent 20%),
                radial-gradient(circle at 90% 80%, rgba(87, 204, 153, 0.05) 0%, transparent 20%);
        }

        /* ------------------------------------------------------------------ */
        /* ğŸ’¡ Ø§Ø³ØªØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ø±ÛŒØ³Ù¾Ø§Ù†Ø³ÛŒÙˆ (Ú©Ù„ÛŒØ¯ Ø¨Ù‡ÛŒÙ†Ù‡â€ŒØ³Ø§Ø²ÛŒ Ù…ÙˆØ¨Ø§ÛŒÙ„) */
        /* ------------------------------------------------------------------ */
        .sidebar {
            background: var(--sidebar-bg);
            color: white;
            min-height: 100vh;
            width: 250px;
            position: fixed;
            right: 0;
            top: 0;
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.1);
            z-index: 1050;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.15);
            overflow-y: auto;
        }

        .main-content {
            margin-right: 250px; /* ÙØ¶Ø§ÛŒ Ø±Ø²Ø±Ùˆ Ø´Ø¯Ù‡ Ø³Ø§ÛŒØ¯Ø¨Ø§Ø± Ø¯Ø± Ø¯Ø³Ú©ØªØ§Ù¾ */
            padding: 20px;
            transition: all 0.3s;
            min-height: 100vh;
        }

        /* Overlay Ø¨Ø±Ø§ÛŒ Ù…ÙˆØ¨Ø§ÛŒÙ„ */
        .sidebar-overlay {
            display: none;
            position: fixed;
            top: 0;
            right: 0;
            left: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.5);
            z-index: 1040;
            transition: opacity 0.3s;
        }

        @media (max-width: 768px) {
            /* 1. Ù¾Ù†Ù‡Ø§Ù† Ú©Ø±Ø¯Ù† Ø³Ø§ÛŒØ¯Ø¨Ø§Ø± Ø¯Ø± Ù…ÙˆØ¨Ø§ÛŒÙ„ */
            .sidebar {
                right: -250px;
            }

            /* 2. Ø¨Ø§Ø² Ú©Ø±Ø¯Ù† Ø³Ø§ÛŒØ¯Ø¨Ø§Ø± Ø¯Ø± Ù…ÙˆØ¨Ø§ÛŒÙ„ */
            .sidebar.active {
                right: 0;
            }

            /* 3. Ø­Ø°Ù Ø­Ø§Ø´ÛŒÙ‡â€ŒÛŒ Ø±Ø²Ø±Ùˆ Ø´Ø¯Ù‡ Ø¯Ø± Ù…ÙˆØ¨Ø§ÛŒÙ„ */
            .main-content {
                margin-right: 0;
            }

            /* 4. Ù†Ù…Ø§ÛŒØ´ Overlay Ù‡Ù†Ú¯Ø§Ù… Ø¨Ø§Ø² Ø¨ÙˆØ¯Ù† Ø³Ø§ÛŒØ¯Ø¨Ø§Ø± */
            .sidebar.active ~ .sidebar-overlay {
                display: block;
            }

            /* 5. Ø¯Ú©Ù…Ù‡ Toggle Ù‡Ù…ÛŒØ´Ù‡ Ø¯Ø± Ù…ÙˆØ¨Ø§ÛŒÙ„ Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ø´ÙˆØ¯ */
            .navbar-brand {
                order: 3; /* Ø§Ù†ØªÙ‚Ø§Ù„ Ø¹Ù†ÙˆØ§Ù† Ø¨Ù‡ Ø³Ù…Øª Ú†Ù¾ Ø¨Ø±Ø§ÛŒ RTL */
            }
            .navbar-nav-scroll {
                max-width: 70%; /* Ø¨Ø±Ø§ÛŒ Ø¬Ù„ÙˆÚ¯ÛŒØ±ÛŒ Ø§Ø² Ø³Ø±Ø±ÛŒØ² Ø´Ø¯Ù† Ù…Ø­ØªÙˆØ§ Ø¯Ø± Ù…ÙˆØ¨Ø§ÛŒÙ„ */
            }

            /* 6. Ú©Ø§Ø±Øªâ€ŒÙ‡Ø§ Ø¯Ø± Ù…ÙˆØ¨Ø§ÛŒÙ„ Ù‡Ù…ÛŒØ´Ù‡ 100% Ø¹Ø±Ø¶ Ø¨Ú¯ÛŒØ±Ù†Ø¯ (Ø¯Ø± ØµÙˆØ±Øª Ù†ÛŒØ§Ø² Ø¨Ù‡ Ø§Ø³ØªÚ© Ø´Ø¯Ù†) */
            .row > div[class*="col-"] {
                margin-bottom: 15px; /* Ø¨Ø±Ø§ÛŒ ÙØ§ØµÙ„Ù‡ Ø¨ÛŒÙ† Ú©Ø§Ø±Øªâ€ŒÙ‡Ø§ Ø¯Ø± Ø­Ø§Ù„Øª Ø¹Ù…ÙˆØ¯ÛŒ */
            }

            /* Ù…Ø®ÙÛŒ Ú©Ø±Ø¯Ù† Ø¯Ú©Ù…Ù‡ Toggle Ø¯Ø§Ø®Ù„ÛŒ (ÙÙ‚Ø· Ø¯Ú©Ù…Ù‡ Ø¨Ø§Ù„Ø§ÛŒ ØµÙØ­Ù‡ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø´ÙˆØ¯) */
            #sidebarClose {
                display: block;
            }
        }

        /* Ø§Ø³ØªØ§ÛŒÙ„ Ø¯Ø³Ú©ØªØ§Ù¾ (Ø¨Ø±Ø§ÛŒ Ø§Ø·Ù…ÛŒÙ†Ø§Ù† Ø§Ø² Ù†Ù…Ø§ÛŒØ´ Ø¯Ø³Ú©ØªØ§Ù¾) */
        @media (min-width: 769px) {
             #sidebarClose {
                display: none !important;
            }
        }

        /* ------------------------------------------------------------------ */
        /* ğŸ¨ Ø§Ø³ØªØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ø¨ØµØ±ÛŒ Ø¬Ø¯ÛŒØ¯ Ùˆ Ø¨Ù‡Ø¨ÙˆØ¯ ÛŒØ§ÙØªÙ‡ */
        /* ------------------------------------------------------------------ */

        /* Ù„ÙˆÚ¯Ùˆ Ø¯Ø± Ø³Ø§ÛŒØ¯Ø¨Ø§Ø± */
        .sidebar-logo {
            padding: 20px;
            text-align: center;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
            background: rgba(0, 0, 0, 0.2);
        }

        .logo-container-sidebar {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 15px;
            text-decoration: none;
            color: white;
        }

        .logo-img-sidebar {
            width: 70px;
            height: 70px;
            background: rgba(255, 255, 255, 1);
            border-radius: 16px;
            padding: 12px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
            object-fit: contain;
        }

        .logo-text-sidebar h4 {
            font-weight: 700;
            margin-bottom: 5px;
            color: white;
            font-size: 1.2rem;
        }

        .logo-text-sidebar small {
            color: rgba(255, 255, 255, 0.7);
            font-size: 0.85rem;
        }

        .logo-highlight {
            color: var(--accent);
            position: relative;
        }

        .logo-highlight::after {
            content: '';
            position: absolute;
            bottom: 2px;
            right: 0;
            width: 100%;
            height: 4px;
            background-color: var(--accent);
            opacity: 0.4;
            border-radius: 2px;
        }

        /* Ù†ÙˆÛŒÚ¯ÛŒØ´Ù† Ø³Ø§ÛŒØ¯Ø¨Ø§Ø± */
        .nav-link {
            color: #adb5bd;
            padding: 14px 20px;
            margin: 5px 10px;
            border-radius: 10px;
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.1);
            display: flex;
            align-items: center;
            position: relative;
            overflow: hidden;
        }

        .nav-link::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.1);
            transform: translateX(-100%);
            transition: transform 0.3s ease;
            z-index: -1;
        }

        .nav-link:hover::before {
            transform: translateX(0);
        }

        .nav-link:hover {
            color: white;
            background: var(--sidebar-link-hover);
            transform: translateX(-5px);
        }

        .nav-link.active {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
            color: white;
            box-shadow: 0 4px 12px rgba(26, 95, 122, 0.4);
            transform: translateX(-5px);
        }

        .nav-link i {
            width: 24px;
            margin-left: 10px;
            text-align: center;
            font-size: 1.1rem;
            transition: transform 0.3s ease;
        }

        .nav-link:hover i {
            transform: scale(1.1);
        }

        .nav-link.active i {
            color: var(--accent);
        }

        /* ğŸ”§ Ø§Ø³ØªØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ø§ØµÙ„Ø§Ø­ Ø´Ø¯Ù‡ Ø¨Ø±Ø§ÛŒ Ø¢Ú©Ø§Ø±Ø¯Ø¦ÙˆÙ† Ùˆ Ø³Ø§Ø®ØªØ§Ø± Ø³Ø§Ø²Ù…Ø§Ù†ÛŒ */
        .accordion-body {
            padding: 0 10px 10px 10px;
            max-height: 300px; /* Ø§Ø±ØªÙØ§Ø¹ Ø­Ø¯Ø§Ú©Ø«Ø± Ø¨Ø±Ø§ÛŒ Ø§Ø³Ú©Ø±ÙˆÙ„ */
            overflow-y: auto; /* ÙØ¹Ø§Ù„ Ú©Ø±Ø¯Ù† Ø§Ø³Ú©Ø±ÙˆÙ„ Ø¹Ù…ÙˆØ¯ÛŒ */
            scrollbar-width: thin; /* Ø¨Ø±Ø§ÛŒ Ù…Ø±ÙˆØ±Ú¯Ø±Ù‡Ø§ÛŒ ÙØ§ÛŒØ±ÙØ§Ú©Ø³ */
        }

        /* Ø§Ø³ØªØ§ÛŒÙ„ Ø§Ø³Ú©Ø±ÙˆÙ„â€ŒØ¨Ø§Ø± Ø³ÙØ§Ø±Ø´ÛŒ Ø¨Ø±Ø§ÛŒ Ø¢Ú©Ø§Ø±Ø¯Ø¦ÙˆÙ† */
        .accordion-body::-webkit-scrollbar {
            width: 4px;
        }

        .accordion-body::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 2px;
        }

        .accordion-body::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.2);
            border-radius: 2px;
        }

        .accordion-body::-webkit-scrollbar-thumb:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        /* Ø¨Ù‡Ø¨ÙˆØ¯ Ø§Ø³ØªØ§ÛŒÙ„ Ù„ÛŒÙ†Ú©â€ŒÙ‡Ø§ÛŒ Ø¯Ø§Ø®Ù„ Ø¢Ú©Ø§Ø±Ø¯Ø¦ÙˆÙ† */
        .accordion-body .nav-link {
            padding: 12px 15px 12px 40px;
            font-size: 0.9rem;
            margin: 3px 0;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .accordion-body .nav-link i {
            font-size: 0.9rem;
            margin-left: 8px;
        }

        /* Ø§Ø³ØªØ§ÛŒÙ„ Ù†Ø´Ø§Ù†Ú¯Ø± Ø§Ø³Ú©Ø±ÙˆÙ„ Ø¨Ø±Ø§ÛŒ Ù…Ø­ØªÙˆØ§ÛŒ Ø¨Ù„Ù†Ø¯ */
        .accordion-body:after {
            content: '';
            position: absolute;
            bottom: 0;
            right: 0;
            left: 0;
            height: 20px;
            background: linear-gradient(to bottom, transparent, rgba(0,0,0,0.1));
            pointer-events: none;
            border-radius: 0 0 10px 10px;
            opacity: 0;
            transition: opacity 0.3s;
        }

        .accordion-body.scrollable:after {
            opacity: 1;
        }

        /* Ø¨Ù‡Ø¨ÙˆØ¯ Ø±ÙØªØ§Ø± Ø¯Ø± Ù…ÙˆØ¨Ø§ÛŒÙ„ */
        @media (max-width: 768px) {
            .accordion-body {
                max-height: 250px; /* Ø§Ø±ØªÙØ§Ø¹ Ú©Ù…ØªØ± Ø¯Ø± Ù…ÙˆØ¨Ø§ÛŒÙ„ */
            }

            /* Ø¬Ù„ÙˆÚ¯ÛŒØ±ÛŒ Ø§Ø² Ø¨Ø§Ø² Ø´Ø¯Ù† Ù‡Ù…Ø²Ù…Ø§Ù† Ú†Ù†Ø¯ Ø¢Ú©Ø§Ø±Ø¯Ø¦ÙˆÙ† Ø¯Ø± Ù…ÙˆØ¨Ø§ÛŒÙ„ */
            .accordion-item {
                margin-bottom: 5px;
            }
        }

        /* Ø¨Ø¯Ø¬ Ù†ÙˆØªÛŒÙÛŒÚ©ÛŒØ´Ù† */
        #notification-badge {
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        /* Ù‡Ø¯Ø± Ø§ØµÙ„ÛŒ */
        .navbar {
            background: white;
            border-radius: 12px;
            padding: 12px 20px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
            margin-bottom: 25px;
            position: sticky;
            top: 10px;
            z-index: 1030;
        }

        .navbar-brand h5 {
            font-weight: 700;
            color: var(--dark);
            margin: 0;
        }

        .navbar-brand h5 i {
            color: var(--primary);
        }

        /* Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ */
        .btn {
            border-radius: 10px;
            padding: 10px 25px;
            font-weight: 600;
            transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.1);
            border: none;
        }

        .btn-outline-secondary {
            border: 1px solid #dee2e6;
            color: #6c757d;
        }

        .btn-outline-secondary:hover {
            background: var(--primary);
            border-color: var(--primary);
            color: white;
            transform: translateY(-3px);
            box-shadow: 0 6px 15px rgba(26, 95, 122, 0.25);
        }

        /* Ú©Ø§Ø±Øªâ€ŒÙ‡Ø§ */
        .card {
            border: none;
            border-radius: 16px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            margin-bottom: 25px;
            overflow: hidden;
            transition: all 0.3s ease;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
        }

        .card-header {
            background: white;
            border-bottom: 1px solid #eee;
            border-radius: 16px 16px 0 0 !important;
            padding: 18px 25px;
            font-weight: 700;
            font-size: 1.2rem;
            color: var(--primary);
            position: relative;
        }

        .card-header::after {
            content: '';
            position: absolute;
            bottom: 0;
            right: 0;
            width: 100%;
            height: 3px;
            background: linear-gradient(90deg, var(--primary) 0%, var(--secondary) 100%);
            opacity: 0.3;
        }

        /* Ú©Ø§Ø±Øª Ø¢Ù…Ø§Ø± */
        .stat-card {
            padding: 30px;
            border-radius: 16px;
            color: white;
            text-align: right;
            position: relative;
            overflow: hidden;
            box-shadow: 0 6px 20px rgba(0,0,0,0.15);
            min-height: 160px;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, rgba(255,255,255,0.1) 0%, transparent 100%);
            z-index: 1;
        }

        .stat-card .number {
            font-size: 2.8rem;
            font-weight: bold;
            display: block;
            position: relative;
            z-index: 2;
        }

        .stat-card .title {
            opacity: 0.9;
            font-size: 1rem;
            position: relative;
            z-index: 2;
        }

        .stat-card i {
            position: absolute;
            left: 20px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 5rem;
            opacity: 0.2;
            z-index: 1;
        }

        /* ØªÛŒØªØ± ØµÙØ­Ù‡ */
        .page-title-container {
            background: white;
            padding: 25px;
            border-radius: 16px;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
            margin-bottom: 30px;
            position: relative;
            overflow: hidden;
        }

        .page-title-container::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 5px;
            height: 100%;
            background: linear-gradient(to bottom, var(--primary) 0%, var(--secondary) 100%);
        }

        .page-title-container h2 {
            font-weight: 800;
            color: var(--dark);
            font-size: 2rem;
            margin: 0;
        }

        /* Ø¬Ø¯Ø§ÙˆÙ„ */
        .table {
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.08);
        }

        .table th {
            background: linear-gradient(135deg, #e9ecef 0%, #dee2e6 100%);
            color: var(--dark);
            font-weight: 700;
            border-bottom: 2px solid #dee2e6;
            padding: 16px 12px;
        }

        .table td {
            padding: 14px 12px;
            vertical-align: middle;
            border-color: #eee;
        }

        .table tbody tr {
            transition: all 0.2s ease;
        }

        .table tbody tr:hover {
            background-color: rgba(26, 95, 122, 0.05);
            transform: translateX(-3px);
        }

        /* ÙØ±Ù…â€ŒÙ‡Ø§ */
        .form-control, .form-select {
            border-radius: 10px;
            padding: 12px 18px;
            border: 2px solid #e9ecef;
            transition: all 0.3s ease;
            font-size: 1rem;
        }

        .form-control:focus, .form-select:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 0.25rem rgba(26, 95, 122, 0.25);
            transform: translateY(-2px);
        }

        /* Ø§Ø¹Ù„Ø§Ù†â€ŒÙ‡Ø§ */
        .alert {
            border-radius: 12px;
            border: none;
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
            font-weight: 600;
            padding: 16px 20px;
            margin-bottom: 20px;
        }

        /* Ù…Ù†ÙˆÛŒ Ø¯Ø±Ø§Ù¾â€ŒØ¯Ø§ÙˆÙ† */
        .dropdown-menu {
            border-radius: 12px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
            border: none;
            padding: 10px;
            margin-top: 10px;
        }

        .dropdown-item {
            padding: 10px 15px;
            border-radius: 8px;
            margin: 3px 0;
            transition: all 0.2s ease;
        }

        .dropdown-item:hover {
            background-color: rgba(26, 95, 122, 0.1);
            color: var(--primary);
            transform: translateX(-5px);
        }

        /* Ø¢Ú©Ø§Ø±Ø¯Ø¦ÙˆÙ† */
        .accordion-button {
            background: transparent !important;
            color: #adb5bd !important;
            box-shadow: none !important;
            padding: 14px 20px;
            font-weight: 600;
            border-radius: 10px !important;
            transition: all 0.3s ease;
        }

        .accordion-button:not(.collapsed) {
            color: white !important;
            background: rgba(255, 255, 255, 0.1) !important;
        }

        .accordion-button:hover {
            background: rgba(255, 255, 255, 0.05) !important;
        }

        .accordion-button::after {
            margin-right: auto;
            margin-left: 10px;
            transform: rotate(90deg);
            transition: transform 0.3s ease;
        }

        .accordion-button:not(.collapsed)::after {
            transform: rotate(-90deg);
        }

        .accordion-collapse {
            border: none !important;
        }

        /* Ø¨Ø®Ø´ Ù¾Ø§ÛŒØ§Ù†ÛŒ Ø³Ø§ÛŒØ¯Ø¨Ø§Ø± */
        .sidebar-footer {
            padding: 20px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            background: rgba(0, 0, 0, 0.2);
        }

        .sidebar-footer .nav-link {
            margin: 5px 0;
        }

        /* Ø§Ø³Ú©Ø±ÙˆÙ„ Ø¨Ø§Ø± Ø³ÙØ§Ø±Ø´ÛŒ Ø¨Ø±Ø§ÛŒ Ø³Ø§ÛŒØ¯Ø¨Ø§Ø± */
        .sidebar::-webkit-scrollbar {
            width: 6px;
        }

        .sidebar::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
        }

        .sidebar::-webkit-scrollbar-thumb {
            background: rgba(255, 255, 255, 0.2);
            border-radius: 3px;
        }

        .sidebar::-webkit-scrollbar-thumb:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        /* Ø§Ù†ÛŒÙ…ÛŒØ´Ù†â€ŒÙ‡Ø§ */
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .animate-fadeIn {
            animation: fadeIn 0.5s ease-out forwards;
        }

        /* Ø§Ø³ØªØ§ÛŒÙ„ Ø¨Ø±Ø§ÛŒ Ø±ÛŒØ³Ù¾Ø§Ù†Ø³ÛŒÙˆ Ø¨ÙˆØ¯Ù† Ø¨Ù‡ØªØ± */
        @media (max-width: 576px) {
            .main-content {
                padding: 15px;
            }

            .stat-card {
                padding: 20px;
                min-height: 140px;
            }

            .stat-card .number {
                font-size: 2.2rem;
            }

            .page-title-container {
                padding: 20px;
            }

            .page-title-container h2 {
                font-size: 1.6rem;
            }
        }

        /* ÙÙˆØªâ€ŒÙ†ÙˆØª Ø¯Ø± Ù¾Ø§ÛŒÛŒÙ† ØµÙØ­Ù‡ */
        .footer-note {
            text-align: center;
            padding: 20px;
            color: #6c757d;
            font-size: 0.9rem;
            margin-top: 40px;
            border-top: 1px solid #eee;
        }

        .footer-note img {
            width: 30px;
            height: 30px;
            margin: 0 10px;
            vertical-align: middle;
            opacity: 0.7;
        }
    </style>
</head>
<body>

    <div class="sidebar">
        <!-- Ù„ÙˆÚ¯Ùˆ Ø¯Ø± Ø³Ø§ÛŒØ¯Ø¨Ø§Ø± -->
        <div class="sidebar-logo">
            <a href="/" class="logo-container-sidebar">
                <img src="/media/img/logo.png" alt="Ù„ÙˆÚ¯ÙˆÛŒ HSE" class="logo-img-sidebar"
                     onerror="this.src='https://cdn-icons-png.flaticon.com/512/1998/1998673.png'">
                <div class="logo-text-sidebar">
                    <h4>Ù¾Ù†Ù„ <span class="logo-highlight">HSE</span></h4>
                    <small>Ù…Ø¯ÛŒØ±ÛŒØª Ø§ÛŒÙ…Ù†ÛŒ Ùˆ Ø¨Ù‡Ø¯Ø§Ø´Øª</small>
                </div>
            </a>
        </div>

        <hr class="border-secondary mx-3 my-2">

        <nav class="nav flex-column">
            {% if company %}
            <a class="nav-link {% if request.resolver_match.url_name == 'dashboard' %}active{% endif %}"
               href="{% url 'hse:dashboard' company.id %}">
                <i class="fas fa-tachometer-alt"></i>
                Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯
            </a>

            <div class="accordion accordion-flush" id="sidebarAccordion">
                <div class="accordion-item" style="background-color: transparent; border: none;">
                    <h2 class="accordion-header">
                        <button class="accordion-button collapsed nav-link d-block text-end" type="button" data-bs-toggle="collapse" data-bs-target="#collapseStructure" aria-expanded="false" aria-controls="collapseStructure">
                            <i class="fas fa-building float-end me-1 mt-1"></i>
                            Ø³Ø§Ø®ØªØ§Ø± Ø³Ø§Ø²Ù…Ø§Ù†ÛŒ
                            <i class="fas fa-chevron-down float-start mt-1" style="font-size: 0.7rem;"></i>
                        </button>
                    </h2>
                    <div id="collapseStructure" class="accordion-collapse collapse" data-bs-parent="#sidebarAccordion">
                        <div class="accordion-body">
                            <a class="nav-link {% if 'company_detail' in request.resolver_match.url_name %}active-sub{% endif %}"
                               href="{% url 'hse:company_detail' company.id %}" >
                                <i class="fas fa-info-circle"></i>
                                Ø¬Ø²Ø¦ÛŒØ§Øª Ø´Ø±Ú©Øª
                            </a>
                            <a class="nav-link {% if 'department' in request.resolver_match.url_name %}active-sub{% endif %}"
                               href="{% url 'hse:department_list' company.id %}" >
                                <i class="fas fa-sitemap"></i>
                                Ù„ÛŒØ³Øª Ø¨Ø®Ø´â€ŒÙ‡Ø§
                            </a>
                            <a class="nav-link {% if 'member' in request.resolver_match.url_name and 'invitation' not in request.resolver_match.url_name %}active-sub{% endif %}"
                               href="{% url 'hse:member_list' company.id %}" >
                                <i class="fas fa-users"></i>
                                Ø§Ø¹Ø¶Ø§ÛŒ Ø´Ø±Ú©Øª
                            </a>
                        </div>
                    </div>
                </div>
            </div>
            <a class="nav-link {% if 'inspection' in request.resolver_match.url_name %}active{% endif %}"
               href="{% url 'hse:inspection_list' company.id %}">
                <i class="fas fa-clipboard-check"></i>
                Ø¨Ø§Ø²Ø±Ø³ÛŒâ€ŒÙ‡Ø§
            </a>

            <a class="nav-link {% if 'incident' in request.resolver_match.url_name %}active{% endif %}"
               href="{% url 'hse:incident_list' company.id %}">
                <i class="fas fa-exclamation-triangle"></i>
                Ø­ÙˆØ§Ø¯Ø«
            </a>

            <a class="nav-link {% if 'task' in request.resolver_match.url_name %}active{% endif %}"
               href="{% url 'hse:task_list' company.id %}">
                <i class="fas fa-tasks"></i>
                ÙˆØ¸Ø§ÛŒÙ
            </a>

            <hr class="border-secondary mx-3 my-2">

            <a class="nav-link {% if 'training' in request.resolver_match.url_name %}active{% endif %}"
               href="{% url 'hse:training_create' company.id %}">
                <i class="fas fa-graduation-cap"></i>
                Ø¢Ù…ÙˆØ²Ø´â€ŒÙ‡Ø§
            </a>

            <a class="nav-link {% if 'invitation' in request.resolver_match.url_name %}active{% endif %}"
               href="{% url 'hse:invitation_list' company.id %}">
                <i class="fas fa-user-plus"></i>
                Ø¯Ø¹ÙˆØª Ùˆ Ø¹Ø¶ÙˆÛŒØª
            </a>

            <a class="nav-link {% if 'ai_assistant' in request.resolver_match.url_name %}active{% endif %}"
               href="{% url 'hse:ai_assistant' %}">
                <i class="fas fa-robot"></i>
                Ù…Ø´Ø§ÙˆØ± Ù‡ÙˆØ´ Ù…ØµÙ†ÙˆØ¹ÛŒ
            </a>

            {% endif %}

            <hr class="border-secondary mx-3 my-2">

            <a class="nav-link {% if 'notification' in request.resolver_match.url_name %}active{% endif %}"
               href="{% url 'hse:notification_list' %}">
                <i class="fas fa-bell"></i>
                Ø§Ø¹Ù„Ø§Ù†â€ŒÙ‡Ø§
                <span id="notification-badge" class="badge bg-danger ms-auto" style="display: none; margin-right: 0;">0</span>
            </a>

            <a class="nav-link {% if request.resolver_match.url_name == 'company_list' %}active{% endif %}"
               href="{% url 'hse:company_list' %}">
                <i class="fas fa-list"></i>
                Ø´Ø±Ú©Øªâ€ŒÙ‡Ø§ÛŒ Ù…Ù†
            </a>

            <a class="nav-link {% if request.resolver_match.url_name == 'company_list' %}active{% endif %}"
               href="{% url 'hse:servicelist' %}">
                <i class="fas fa-cogs"></i>
               Ø®Ø¯Ù…Ø§Øª Ù…Ø§
            </a>

            <div class="sidebar-footer mt-auto">
                <a class="nav-link text-danger" href="#">
                    <i class="fas fa-sign-out-alt"></i>
                    Ø®Ø±ÙˆØ¬
                </a>
            </div>
        </nav>
    </div>

    <div class="sidebar-overlay" id="sidebarOverlay"></div>

    <div class="main-content">
        <nav class="navbar navbar-light bg-white rounded-3 shadow-sm mb-4 animate-fadeIn">
            <div class="container-fluid">
                <button class="btn btn-outline-secondary d-md-none" id="sidebarToggle">
                    <i class="fas fa-bars"></i>
                </button>

                <div class="navbar-brand me-auto ms-3">
                    <h5 class="mb-0">
                        {% if company %}
                        <i class="fas fa-industry me-2" style="color: var(--primary);"></i>
                        {{ company.name }}
                        {% else %}
                        <i class="fas fa-shield-alt me-2" style="color: var(--primary);"></i>
                        <span style="color: var(--dark); font-weight: 700;">Ø³ÛŒØ³ØªÙ… HSE</span>
                        {% endif %}
                    </h5>
                </div>

                <div class="dropdown">
                    <button class="btn btn-outline-secondary dropdown-toggle" type="button" data-bs-toggle="dropdown">
                        <i class="fas fa-user me-2"></i>
                        {{ request.user.get_full_name|default:request.user.name|default:"Ú©Ø§Ø±Ø¨Ø±" }}
                    </button>
                    <ul class="dropdown-menu dropdown-menu-start">
                        <li><a class="dropdown-item" href="#"><i class="fas fa-user-cog me-2"></i>Ù¾Ø±ÙˆÙØ§ÛŒÙ„</a></li>
                        <li><a class="dropdown-item" href="#"><i class="fas fa-cog me-2"></i>ØªÙ†Ø¸ÛŒÙ…Ø§Øª</a></li>
                        <li><hr class="dropdown-divider"></li>
                        <li><a class="dropdown-item text-danger" href="{% url 'account:logout' %}"><i class="fas fa-sign-out-alt me-2"></i>Ø®Ø±ÙˆØ¬</a></li>
                    </ul>
                </div>
            </div>
        </nav>

        {% if messages %}
        <div class="messages mb-4 animate-fadeIn">
            {% for message in messages %}
            <div class="alert alert-{{ message.tags }} alert-dismissible fade show">
                <div class="d-flex align-items-center">
                    <i class="fas fa-{% if message.tags == 'success' %}check-circle{% elif message.tags == 'error' %}exclamation-circle{% elif message.tags == 'warning' %}exclamation-triangle{% else %}info-circle{% endif %} me-2"></i>
                    <div>{{ message }}</div>
                </div>
                <button type="button" class="btn-close me-auto" data-bs-dismiss="alert" aria-label="Close"></button>
            </div>
            {% endfor %}
        </div>
        {% endif %}

        <div class="d-flex justify-content-between align-items-center mb-4 page-title-container animate-fadeIn">
            <h2 class="mb-0">
                {% block page_title %}{{ page_title|default:"Ø¯Ø§Ø´Ø¨ÙˆØ±Ø¯ Ø§ØµÙ„ÛŒ" }}{% endblock %}
            </h2>
            {% block page_actions %}{% endblock %}
        </div>

        {% block content %}{% endblock %}

        <!-- ÙÙˆØªâ€ŒÙ†ÙˆØª Ø¨Ø§ Ù„ÙˆÚ¯Ùˆ -->
        <div class="footer-note animate-fadeIn">
            <p>
                <img src="/media/img/logo.png" alt="Ù„ÙˆÚ¯ÙˆÛŒ HSE"
                     onerror="this.src='https://cdn-icons-png.flaticon.com/512/1998/1998673.png'">
                Ú©Ù„ÛŒÙ‡ Ø­Ù‚ÙˆÙ‚ Ø§ÛŒÙ† Ù¾Ù†Ù„ Ù…ØªØ¹Ù„Ù‚ Ø¨Ù‡ Ø³ÛŒØ³ØªÙ… Ù…Ø¯ÛŒØ±ÛŒØª HSE Ù…ÛŒâ€ŒØ¨Ø§Ø´Ø¯ Â© Û²Û°Û²Û³
            </p>
            <small>Ø·Ø±Ø§Ø­ÛŒ ØªÙˆØ³Ø· Ø´Ø±Ú©Øª <a rel='nofollow' href="https://rank0.ir"></a> <i class="fas fa-heart text-danger mx-1"></i></small>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>

    <script>
        // ğŸ’¡ Ù…Ù†Ø·Ù‚ Ø¬Ø¯ÛŒØ¯ Ø¬Ø§ÙˆØ§ Ø§Ø³Ú©Ø±ÛŒÙ¾Øª Ø¨Ø±Ø§ÛŒ Ù…Ø¯ÛŒØ±ÛŒØª Ø³Ø§ÛŒØ¯Ø¨Ø§Ø± Ù…ÙˆØ¨Ø§ÛŒÙ„ Ùˆ Overlay
        $(document).ready(function() {
            const sidebar = $('.sidebar');
            const sidebarToggle = $('#sidebarToggle');
            const sidebarOverlay = $('#sidebarOverlay');

            function toggleSidebar() {
                sidebar.toggleClass('active');
                if (sidebar.hasClass('active')) {
                    // Ø¬Ù„ÙˆÚ¯ÛŒØ±ÛŒ Ø§Ø² Ø§Ø³Ú©Ø±ÙˆÙ„ Ø¨Ø¯Ù†Ù‡ Ø²ÛŒØ± Ø³Ø§ÛŒØ¯Ø¨Ø§Ø±
                    $('body').css('overflow', 'hidden');
                    sidebarOverlay.fadeIn(200);
                } else {
                    $('body').css('overflow', 'auto');
                    sidebarOverlay.fadeOut(200);
                }
            }

            // Ø¨Ø§Ø² Ú©Ø±Ø¯Ù† Ø³Ø§ÛŒØ¯Ø¨Ø§Ø± Ø¨Ø§ Ø¯Ú©Ù…Ù‡ Ø¨Ø§Ù„Ø§
            sidebarToggle.on('click', toggleSidebar);

            // Ø¨Ø³ØªÙ† Ø³Ø§ÛŒØ¯Ø¨Ø§Ø± Ø¨Ø§ Ú©Ù„ÛŒÚ© Ø±ÙˆÛŒ Overlay
            sidebarOverlay.on('click', toggleSidebar);

            // ğŸ”§ Ø¨Ù‡Ø¨ÙˆØ¯ Ú©Ù„ÛŒÚ© Ø±ÙˆÛŒ Ù„ÛŒÙ†Ú©â€ŒÙ‡Ø§ÛŒ Ø¯Ø§Ø®Ù„ Ø¢Ú©Ø§Ø±Ø¯Ø¦ÙˆÙ†
            $('.accordion-body .nav-link').on('click', function(e) {
                if ($(window).width() <= 768) {
                    // ÙÙ‚Ø· Ø¨Ø±Ø§ÛŒ Ù…ÙˆØ¨Ø§ÛŒÙ„
                    setTimeout(function() {
                        // Ø¨Ø³ØªÙ† Ø³Ø§ÛŒØ¯Ø¨Ø§Ø± Ø¨Ø§ ØªØ§Ø®ÛŒØ± Ú©Ù…ÛŒ
                        if ($('.sidebar').hasClass('active')) {
                            $('.sidebar').removeClass('active');
                            $('body').css('overflow', 'auto');
                            $('#sidebarOverlay').fadeOut(200);
                        }
                    }, 100);
                }
            });

            // Ø§Ø³Ú©Ø±ÙˆÙ„ Ù†Ø±Ù… Ø¨Ø±Ø§ÛŒ Ù„ÛŒÙ†Ú©â€ŒÙ‡Ø§ÛŒ Ø¯Ø§Ø®Ù„ÛŒ
            $('a[href^="#"]').on('click', function(e) {
                if (this.hash !== "") {
                    e.preventDefault();
                    const hash = this.hash;
                    $('html, body').animate({
                        scrollTop: $(hash).offset().top - 100
                    }, 800, 'swing');
                }
            });

            // -----------------------------------------------------
            // Ù…Ù†Ø·Ù‚ Ù†ÙˆØªÛŒÙÛŒÚ©ÛŒØ´Ù†
            // -----------------------------------------------------
            function updateNotificationBadge() {
                $.get('{% url "hse:notification_count" %}', function(data) {
                    const badge = $('#notification-badge');
                    if (data.count > 0) {
                        badge.text(data.count).show();
                    } else {
                        badge.hide();
                    }
                });
            }

            updateNotificationBadge();
            // 30 Ø«Ø§Ù†ÛŒÙ‡
            setInterval(updateNotificationBadge, 30000);

            // Auto-hide alerts after 5 seconds
            setTimeout(function() {
                $('.alert').alert('close');
            }, 5000);

            // Ø§ÙØ²ÙˆØ¯Ù† Ø§Ù†ÛŒÙ…ÛŒØ´Ù† Ø¨Ù‡ Ø¹Ù†Ø§ØµØ± Ù‡Ù†Ú¯Ø§Ù… Ø§Ø³Ú©Ø±ÙˆÙ„
            const observerOptions = {
                threshold: 0.1,
                rootMargin: '0px 0px -50px 0px'
            };

            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('animate-fadeIn');
                    }
                });
            }, observerOptions);

            // Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ø¹Ù†Ø§ØµØ± Ø¨Ø±Ø§ÛŒ Ø§Ù†ÛŒÙ…ÛŒØ´Ù†
            document.querySelectorAll('.card, .stat-card').forEach(el => {
                observer.observe(el);
            });

            // Ù…Ø¯ÛŒØ±ÛŒØª Ø®Ø·Ø§ÛŒ Ù„ÙˆÚ¯Ùˆ
            $('.logo-img-sidebar').on('error', function() {
                this.src = 'https://cdn-icons-png.flaticon.com/512/1998/1998673.png';
            });

            // ğŸ”§ Ø¹Ù…Ù„Ú©Ø±Ø¯ Ø¢Ú©Ø§Ø±Ø¯Ø¦ÙˆÙ† Ø¯Ø± Ù…ÙˆØ¨Ø§ÛŒÙ„
            $('.accordion-button').on('click', function(e) {
                const isMobile = $(window).width() <= 768;
                const accordionBody = $($(this).attr('data-bs-target'));

                if (isMobile) {
                    // ÙÙ‚Ø· Ø¯Ø± Ù…ÙˆØ¨Ø§ÛŒÙ„: Ø¬Ù„ÙˆÚ¯ÛŒØ±ÛŒ Ø§Ø² Ø¨Ø³ØªÙ‡ Ø´Ø¯Ù† Ø³Ø§ÛŒØ¯Ø¨Ø§Ø±
                    e.stopPropagation();

                    // Ø§Ú¯Ø± Ø¢Ú©Ø§Ø±Ø¯Ø¦ÙˆÙ† Ù‚Ø¨Ù„Ø§Ù‹ Ø¨Ø§Ø² Ø§Ø³ØªØŒ Ø¢Ù† Ø±Ø§ Ø¨Ø¨Ù†Ø¯
                    if ($(this).hasClass('collapsed')) {
                        // Ø¨Ø§Ø² Ú©Ø±Ø¯Ù† Ø¢Ú©Ø§Ø±Ø¯Ø¦ÙˆÙ†
                        $(this).removeClass('collapsed');
                        $(this).attr('aria-expanded', 'true');
                        accordionBody.collapse('show');
                    } else {
                        // Ø¨Ø³ØªÙ† Ø¢Ú©Ø§Ø±Ø¯Ø¦ÙˆÙ†
                        $(this).addClass('collapsed');
                        $(this).attr('aria-expanded', 'false');
                        accordionBody.collapse('hide');
                    }

                    // Ø¬Ù„ÙˆÚ¯ÛŒØ±ÛŒ Ø§Ø² Ø§Ø¬Ø±Ø§ÛŒ Ø±ÙˆÛŒØ¯Ø§Ø¯ Ù¾ÛŒØ´â€ŒÙØ±Ø¶ Ø¨ÙˆØªâ€ŒØ§Ø³ØªØ±Ù¾
                    return false;
                }
            });

            // ğŸ”§ Ø¨Ø±Ø±Ø³ÛŒ Ù…Ø­ØªÙˆØ§ÛŒ Ø§Ø³Ú©Ø±ÙˆÙ„â€ŒÙ¾Ø°ÛŒØ± Ø¯Ø± Ø¢Ú©Ø§Ø±Ø¯Ø¦ÙˆÙ†
            function checkScrollableContent() {
                $('.accordion-body').each(function() {
                    const $this = $(this);
                    if ($this[0].scrollHeight > $this.innerHeight()) {
                        $this.addClass('scrollable');
                    } else {
                        $this.removeClass('scrollable');
                    }
                });
            }

            // Ø¨Ø±Ø±Ø³ÛŒ Ù…Ø­ØªÙˆØ§ Ù¾Ø³ Ø§Ø² Ø¨Ø§Ø² Ø´Ø¯Ù† Ø¢Ú©Ø§Ø±Ø¯Ø¦ÙˆÙ†
            $('.accordion').on('shown.bs.collapse', function() {
                setTimeout(checkScrollableContent, 300);
            });

            // Ø¨Ø±Ø±Ø³ÛŒ Ø§ÙˆÙ„ÛŒÙ‡
            setTimeout(checkScrollableContent, 500);

            // Ø¨Ø±Ø±Ø³ÛŒ Ù‡Ù†Ú¯Ø§Ù… ØªØºÛŒÛŒØ± Ø§Ù†Ø¯Ø§Ø²Ù‡ Ù¾Ù†Ø¬Ø±Ù‡
            $(window).on('resize', checkScrollableContent);

            // Ø¨Ø³ØªÙ† Ø³Ø§ÛŒØ¯Ø¨Ø§Ø± Ù‡Ù†Ú¯Ø§Ù… Ú©Ù„ÛŒÚ© Ø±ÙˆÛŒ Ù„ÛŒÙ†Ú©â€ŒÙ‡Ø§ÛŒ Ù…Ø¹Ù…ÙˆÙ„ÛŒ (ØºÛŒØ± Ø¢Ú©Ø§Ø±Ø¯Ø¦ÙˆÙ†)
            $('.nav-link').not('.accordion-button').not('.accordion-body .nav-link').on('click', function(e) {
                if ($(window).width() <= 768 && !$(this).hasClass('sidebar-logo')) {
                    setTimeout(function() {
                        if ($('.sidebar').hasClass('active')) {
                            $('.sidebar').removeClass('active');
                            $('body').css('overflow', 'auto');
                            $('#sidebarOverlay').fadeOut(200);
                        }
                    }, 300);
                }
            });
        });

        // Ù¾ÛŒØ§Ù… Ú©Ù†Ø³ÙˆÙ„ Ø¨Ø±Ø§ÛŒ ØªÙˆØ³Ø¹Ù‡â€ŒØ¯Ù‡Ù†Ø¯Ú¯Ø§Ù†
        console.log('%cğŸš€ Ù¾Ù†Ù„ Ù…Ø¯ÛŒØ±ÛŒØª HSE ğŸš€', 'color: #1a5f7a; font-size: 16px; font-weight: bold; padding: 5px;');
        console.log('%câœ¨ Ø³ÛŒØ³ØªÙ… Ù…Ø¯ÛŒØ±ÛŒØª Ø§ÛŒÙ…Ù†ÛŒ Ùˆ Ø¨Ù‡Ø¯Ø§Ø´Øª | Ù†Ø³Ø®Ù‡ Û².Û° âœ¨', 'color: #57cc99; font-size: 12px;');
    </script>

    {% block extra_js %}{% endblock %}
</body>
</html>